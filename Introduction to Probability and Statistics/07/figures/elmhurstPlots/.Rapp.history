library(openintro)#
#
load('elmhurst.rda')#
d <- elmhurst
plot(d$family_income, d$gift_aid,#
     col='#22558863', pch=20, cex=1.5,#
     xlab='Family Income ($1000s)',#
     ylab='Gift Aid From University')
plot(d$family_income, d$gift_aid,#
     col='#22558863', pch=20, cex=1.5,#
     xlab='Family Income ($1000s)',#
     ylab='Gift Aid From University',#
     xlim=c(0, 360))
library(openintro)#
#
load('elmhurst.rda')#
d <- elmhurst#
#
#plot(d$SATM, d$FYGPA, col=fadeColor(d$sex, '88'), pch=c(1,20)[d$sex], cex=c(1,1.5)[d$sex])#
#g <- lm(d$FYGPA ~ I(d$SATM))#
#summary(g)#
#
myPDF('elmhurstScatter.pdf', 5, 3.3, mar=c(3, 3, 1, 1), mgp=c(1.8, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558863', pch=20, cex=1.5,#
     xlab='Family Income ($1000s)',#
     ylab='Gift Aid From University',#
     xlim=c(0, 360))#
#
dev.off()
library(openintro)#
#
load('elmhurst.rda')#
d <- elmhurst#
#
#plot(d$SATM, d$FYGPA, col=fadeColor(d$sex, '88'), pch=c(1,20)[d$sex], cex=c(1,1.5)[d$sex])#
#g <- lm(d$FYGPA ~ I(d$SATM))#
#summary(g)#
#
myPDF('elmhurstScatter.pdf', 5, 3.3, mar=c(3, 3, 1, 1), mgp=c(1.8, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558863', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='Gift Aid From University',#
     xlim=c(0, 360))#
#
dev.off()
library(openintro)#
#
load('elmhurst.rda')#
d <- elmhurst#
#
#plot(d$SATM, d$FYGPA, col=fadeColor(d$sex, '88'), pch=c(1,20)[d$sex], cex=c(1,1.5)[d$sex])#
#g <- lm(d$FYGPA ~ I(d$SATM))#
#summary(g)#
#
myPDF('elmhurstScatter.pdf', 5, 3.3, mar=c(3, 3, 1, 1), mgp=c(1.8, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='Gift Aid From University',#
     xlim=c(0, 360))#
#
dev.off()
library(openintro)#
#
load('elmhurst.rda')#
d <- elmhurst#
#
#plot(d$SATM, d$FYGPA, col=fadeColor(d$sex, '88'), pch=c(1,20)[d$sex], cex=c(1,1.5)[d$sex])#
#g <- lm(d$FYGPA ~ I(d$SATM))#
#summary(g)#
#
myPDF('elmhurstScatter.pdf', 5, 3.3, mar=c(3, 3, 1, 1), mgp=c(1.8, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='Gift Aid From University',#
     xlim=c(0, 360), axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
#
dev.off()
library(openintro)#
#
load('elmhurst.rda')#
d <- elmhurst#
#
#plot(d$SATM, d$FYGPA, col=fadeColor(d$sex, '88'), pch=c(1,20)[d$sex], cex=c(1,1.5)[d$sex])#
#g <- lm(d$FYGPA ~ I(d$SATM))#
#summary(g)#
#
myPDF('elmhurstScatter.pdf', 5, 3.3, mar=c(3, 3, 1, 1), mgp=c(1.8, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='Gift Aid From University',#
     xlim=c(0, 360), axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
d <- elmhurst#
#
myPDF('elmhurstScatter.pdf', 5, 3.3, mar=c(3, 3, 1, 1), mgp=c(1.8, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='Gift Aid From University',#
     xlim=c(0, 360), axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
#
dev.off()
sum(d$family_income > 360)
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='Gift Aid From University')
library(openintro)#
load('elmhurst.rda')#
d <- elmhurst#
#
myPDF('elmhurstScatter.pdf', 5, 3.3, mar=c(3, 3, 1, 1), mgp=c(1.8, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='Gift Aid From University'),#
     xlim=c(0, 360), axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
sum(d$family_income > 360)#
text(300, 30, "2 observations had\nfamily incomes\ngreater than 360,000")#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
d <- elmhurst#
#
myPDF('elmhurstScatter.pdf', 5, 3.3, mar=c(3, 3, 1, 1), mgp=c(1.8, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='Gift Aid From University',#
     xlim=c(0, 360), axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
sum(d$family_income > 360)#
text(300, 30, "2 students with\nfamily incomes\ngreater than 360,000 are not shown")#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
d <- elmhurst#
#
myPDF('elmhurstScatter.pdf', 5, 3.3, mar=c(3, 3, 1, 1), mgp=c(1.8, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='Gift Aid From University',#
     xlim=c(0, 360), axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
sum(d$family_income > 360)#
text(300, 30, "2 students with\nfamily incomes\ngreater than 360,000\nare not shown")#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
d <- elmhurst#
#
myPDF('elmhurstScatter.pdf', 5, 3.3, mar=c(3, 3, 1, 1), mgp=c(1.8, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='Gift Aid From University',#
     xlim=c(0, 360), axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
sum(d$family_income > 360)#
text(290, 30, "2 students with\nfamily incomes\ngreater than 360,000\nare not shown")#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
d <- elmhurst#
#
myPDF('elmhurstScatter.pdf', 5, 3.3, mar=c(3, 3, 1, 1), mgp=c(1.8, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='Gift Aid From University',#
     xlim=c(0, 360), axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
sum(d$family_income > 360)#
text(290, 30, "2 students with\nfamily income\ngreater than 360,000\nare not shown")#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
d <- elmhurst#
#
myPDF('elmhurstScatter.pdf', 5, 3.3, mar=c(3, 3, 1, 1), mgp=c(1.8, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='Gift Aid From University',#
     xlim=c(0, 360), axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
sum(d$family_income > 360)#
text(290, 30, "2 students with\nfamily income\ngreater than $360,000\nare not shown")#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
d <- elmhurst#
#
myPDF('elmhurstScatter.pdf', 5, 3.3, mar=c(3, 3, 1, 1), mgp=c(1.8, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='Gift Aid From University',#
     xlim=c(0, 360), axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
sum(d$family_income > 360)#
text(290, 30, "2 students with\nfamily income\ngreater than $360,000\nare not shown", cex=0.7)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
d <- elmhurst#
#
myPDF('elmhurstScatter.pdf', 5, 3.3, mar=c(3, 3.6, 1, 1), mgp=c(1.8, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='',#
     xlim=c(0, 360), axes=FALSE)#
mtext("Gift Aid From University", 2, line=2.5)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
sum(d$family_income > 360)#
text(290, 30, "2 students with\nfamily income\ngreater than $360,000\nare not shown", cex=0.7)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
d <- elmhurst#
#
myPDF('elmhurstScatter.pdf', 5, 3.3, mar=c(3, 3.6, 1, 1), mgp=c(1.8, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='',#
     xlim=c(0, 360), axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
sum(d$family_income > 360)#
text(290, 30, "2 students with\nfamily income\ngreater than $360,000\nare not shown", cex=0.7)#
par(las=0)#
mtext("Gift Aid From University", 2, line=2.5)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
d <- elmhurst#
#
myPDF('elmhurstScatter.pdf', 5.5, 3.3, mar=c(3, 3.6, 1, 1), mgp=c(1.8, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='',#
     xlim=c(0, 360), axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
sum(d$family_income > 360)#
text(290, 30, "2 students with\nfamily income\ngreater than $360,000\nare not shown", cex=0.7)#
par(las=0)#
mtext("Gift Aid From University", 2, line=2.5)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
d <- elmhurst#
#
myPDF('elmhurstScatter.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='',#
     xlim=c(0, 360), axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
sum(d$family_income > 360)#
text(290, 30, "2 students with\nfamily income\ngreater than $360,000\nare not shown", cex=0.7)#
par(las=0)#
mtext("Gift Aid From University", 2, line=2.5)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
#
myPDF('elmhurstScatter.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='',#
     xlim=c(0, 360), axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
sum(d$family_income > 360)#
text(290, 30, "2 students with\nfamily income\ngreater than $360,000\nare not shown", cex=0.7)#
par(las=0)#
mtext("Gift Aid From University", 2, line=2.5)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(1)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
any(d$family_income > 300)#
myPDF('elmhurstScatter.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='',#
     xlim=c(0, 360), axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
text(290, 30, "2 students with\nfamily income\ngreater than $360,000\nare not shown", cex=0.7)#
par(las=0)#
mtext("Gift Aid From University", 2, line=2.5)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
any(d$family_income > 300)#
myPDF('elmhurstScatter.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='',#
     xlim=c(0, 360), axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
text(290, 30, "2 students with\nfamily income\ngreater than $360,000\nare not shown", cex=0.7)#
par(las=0)#
mtext("Gift Aid From University", 2, line=2.5)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
any(d$family_income > 350)#
myPDF('elmhurstScatter.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='',#
     xlim=c(0, 360), axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
text(290, 30, "2 students with\nfamily income\ngreater than $360,000\nare not shown", cex=0.7)#
par(las=0)#
mtext("Gift Aid From University", 2, line=2.5)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
myPDF('elmhurstScatter.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
text(290, 30, "2 students with\nfamily income\ngreater than $360,000\nare not shown", cex=0.7)#
par(las=0)#
mtext("Gift Aid From University", 2, line=2.5)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
myPDF('elmhurstScatter.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE)#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University", 2, line=2.5)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
myPDF('elmhurstScatter.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 310), ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University", 2, line=2.5)#
#
dev.off()
?par
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
myPDF('elmhurstScatter.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1, omd=5)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 310), ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University", 2, line=2.5)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
myPDF('elmhurstScatter.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1, omd=0.1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 310), ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University", 2, line=2.5)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
myPDF('elmhurstScatter.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1, omd=c(0.1, 0.1, 0.1, 0.1))#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 310), ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University", 2, line=2.5)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
myPDF('elmhurstScatter.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 310), ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University", 2, line=2.5)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]
g <- lm(d$gift_aid ~ I(d$family_income))#
summary(g)
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a <- seq(20, 26, 0.01)#
b <- seq(0, 0.06, 0.001)#
mins <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}
}
theMin
mins
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a <- seq(20, 26, 0.01)#
b <- seq(-0.06, 0, 0.001)#
mins <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
}
mins
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- seq(20, 26, 0.001)#
b      <- seq(-0.06, 0, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- seq(20, 26, 0.005)#
b      <- seq(-0.06, 0, 0.0005)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}
mins
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- seq(22.5, 23.5, 0.001)#
b      <- seq(-0.035, -0.025, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}
mins
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- seq(22.8, 23, 0.0005)#
b      <- seq(-0.030, -0.028, 0.00005)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}
mins
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- seq(22.5, 23.5, 0.001)#
b      <- seq(-0.035, -0.025, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- seq(22.5, 23.5, 0.001)#
b      <- seq(-0.035, -0.025, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}#
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 310), ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(10)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- seq(22.5, 23.5, 0.001)#
b      <- seq(-0.035, -0.025, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}#
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 310), ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- seq(22.5, 23.5, 0.001)#
b      <- seq(-0.035, -0.025, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}#
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 310), ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
cor(d$family_income, d$gift_aid)
library(openintro)#
load('elmhurst.rda')#
set.seed(5)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- seq(22.5, 23.5, 0.001)#
b      <- seq(-0.035, -0.025, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}#
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 310), ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
plot(g)
library(openintro)#
load('elmhurst.rda')#
set.seed(50)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
max(d$family_income)
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- seq(22.5, 23.5, 0.001)#
b      <- seq(-0.035, -0.025, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}#
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 310), ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(100)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
max(d$family_income)
library(openintro)#
load('elmhurst.rda')#
set.seed(20)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
max(d$family_income)
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- seq(22.5, 23.5, 0.001)#
b      <- seq(-0.035, -0.025, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}#
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 310), ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(20)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
max(d$family_income)#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- seq(23.5, 24.5, 0.001)#
b      <- seq(-0.043, -0.033, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}#
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 280), ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(30)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
max(d$family_income)
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 280), ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     #xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(25)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
max(d$family_income)
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     #xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(25)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
max(d$family_income)#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- seq(23.5, 24.5, 0.001)#
b      <- seq(-0.043, -0.033, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}#
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(2)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
max(d$family_income)
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     #xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(2)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
max(d$family_income)#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- seq(23.5, 24.5, 0.001)#
b      <- seq(-0.043, -0.033, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}#
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     #xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(2)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
max(d$family_income)#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- 26.25 + seq(-0.5, 0.5, 0.001)#
b      <- -0.059 + seq(-0.0025, -0.025, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}#
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     #xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(2)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
max(d$family_income)#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- 26.25 + seq(-0.5, 0.5, 0.001)#
b      <- -0.059 + seq(-0.025, 0.025, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}#
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     #xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
g
g$coef
g
summary(g)
library(openintro)#
load('elmhurst.rda')#
set.seed(3)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
max(d$family_income)#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- round(g$coef[1], 2) + seq(-0.4, 0.4, 0.001)#
b      <- round(g$coef[2], 3) + seq(-0.01, 0.01, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}#
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     #xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
library(openintro)#
load('elmhurst.rda')#
set.seed(4)#
s <- sample(nrow(elmhurst), 50)#
d <- elmhurst[s,]#
max(d$family_income)#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- round(g$coef[1], 2) + seq(-0.4, 0.4, 0.001)#
b      <- round(g$coef[2], 3) + seq(-0.01, 0.01, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}#
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     #xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
save(d, file="d.rda")
mins
coef
g
library(openintro)#
load('d.rda')#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- round(g$coef[1], 2) + seq(-0.5, 0.5, 0.001)#
b      <- round(g$coef[2], 3) + seq(-0.01, 0.01, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}#
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     #xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
range(d[,1])
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
g
mean(d$family_income)
sd(d$family_income)
sd(d$gift_aid)
mean(d$gift_aid)
cor(d$family_income, d$gift_aid)
-0.499*5.46/63.2
-0.0431*(-101.8) + 19.94
library(xtable)
xtable(g)
24.3 - 0.0431*300
24.3 - 0.0431*500
24.3 - 0.0431*1000
load("/Users/ddiez/Dropbox/Data/Elmhurst/FinalData/elmhurst.rda")
any(elmhurst[,2] == 0)
which(elmhurst[,2] == 0)
hist(elmhurst[,2])
elmhurst[476,]
library(openintro)#
load('d.rda')#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- round(g$coef[1], 2) + seq(-0.5, 0.5, 0.001)#
b      <- round(g$coef[2], 3) + seq(-0.01, 0.01, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}#
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()#
myPDF('elmhurstScatterWLSROnly.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col='#22558888', pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
#abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
sd(d$gift_aid)
var(d$gift_aid)
4.46^2
5.46^2
g$residual
var(g$residual)
summary(g)
4.783^2
var(g$res)
22.9/28.8
.499^2
22.4/28.8
g
cor(d$family_income, d$gift_aid)
var(d$gift_aid)
7/29.9
7.5/29.9
.499^2
library(openintro)#
load('d.rda')#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)
xtable(g)
library(xtable)
xtable(g)
library(openintro)#
data(COL)#
load('d.rda')#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- round(g$coef[1], 2) + seq(-0.5, 0.5, 0.001)#
b      <- round(g$coef[2], 3) + seq(-0.01, 0.01, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}#
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col=COL[1,2], pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()#
myPDF('elmhurstScatterWLSROnly.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col=COL[1,2], pch=20, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
#abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
library(openintro)#
data(COL)#
load('d.rda')#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- round(g$coef[1], 2) + seq(-0.5, 0.5, 0.001)#
b      <- round(g$coef[2], 3) + seq(-0.01, 0.01, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}#
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col=COL[1,2], pch=19, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()#
myPDF('elmhurstScatterWLSROnly.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col=COL[1,2], pch=19, cex=1,#
     xlab='Family Income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift Aid From University ($1000s)", 2, line=2.5)#
#abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
library(openintro)#
data(COL)#
load('d.rda')#
#
g <- lm(d$gift_aid ~ d$family_income)#
summary(g)#
#
loss <- function(a, b, d){#
	p <- a + b*d$family_income#
	sum(abs(d$gift_aid - p))#
}#
a      <- round(g$coef[1], 2) + seq(-0.5, 0.5, 0.001)#
b      <- round(g$coef[2], 3) + seq(-0.01, 0.01, 0.0001)#
mins   <- c(a[1], b[1])#
theMin <- loss(a[1], b[1], d)#
pb     <- txtProgressBar(1, length(a), style=3)#
for(i in 1:length(a)){#
	for(j in 1:length(b)){#
		hold <- loss(a[i], b[j], d)#
		if(hold < theMin){#
			mins <- c(a[i],b[j])#
			theMin <- hold#
		}#
	}#
	setTxtProgressBar(pb, i)#
}#
myPDF('elmhurstScatterW2Lines.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col=COL[1,2], pch=19, cex=1,#
     xlab='Family income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift aid from university ($1000s)", 2, line=2.5)#
abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()#
myPDF('elmhurstScatterWLSROnly.pdf', 5.5, 3.3, mar=c(3.1, 3.6, 1, 1), mgp=c(2, 0.6, 0), las=1)#
#
plot(d$family_income, d$gift_aid,#
     col=COL[1,2], pch=19, cex=1,#
     xlab='Family income ($1000s)',#
     ylab='', axes=FALSE,#
     xlim=c(0, 280), #
     ylim=c(0, 35))#
axis(1, at=(0:4)*100)#
axis(2, at=(0:3)*10)#
box()#
par(las=0)#
mtext("Gift aid from university ($1000s)", 2, line=2.5)#
#abline(mins[1], mins[2], lty=2, lwd=2)#
abline(g, lwd=2)#
#
dev.off()
library(openintro)
?elmhurst
library(help=openintro)
load("/Users/ddiez/Dropbox/Second Edition/07/figures/elmhurstPlots/d.rda")
d
dim(d)
write.table(d, file="elmhurst.txt", quote=FALSE, sep="\t", row.names=FALSE)
d[,1] + d[,2]
